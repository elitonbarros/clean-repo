<!DOCTYPE html>
<html>
<head>
  <title>Twilio Outbound Call</title>
  <script src="https://sdk.twilio.com/js/client/v1.13/twilio.min.js"></script>
</head>
<body>
  <h2>Make a Call from your Twilio Number</h2>
  <input type="text" id="phoneNumber" placeholder="+15551234567" />
  <button onclick="makeCall()">Call Now</button>
  <button onclick="hangUp()">Hang Up</button>

  <script>
    fetch('/token')
      .then(response => response.text())
      .then(token => {
        console.log("✅ Token fetched:", token);
        Twilio.Device.setup(token);

        Twilio.Device.ready(function () {
          console.log("🎉 Device is ready!");
        });

        Twilio.Device.error(function (error) {
          console.error("❌ Twilio.Device error:", error.message);
        });
      })
      .catch(error => {
        console.error("❌ Failed to fetch token:", error);
      });

    // ✅ Nome correto da função
    function makeCall() {
      const phoneNumber = document.getElementById('phoneNumber').value;
      const params = { To: phoneNumber };
      console.log("📞 Making call with params:", params);
      Twilio.Device.connect(params);
    }
     function hangUp() {
     console.log("🛑 Hanging up the call...");
     Twilio.Device.disconnectAll();
}

  </script>
</body>
</html>
